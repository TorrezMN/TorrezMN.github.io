<!doctype html>
<html>
    <head>
                <title>Gists from console - Torrez MN</title>

            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">

            
            
            

            
                <link  rel="icon" type="image/x-icon" href="../../assets/img/favicon.ico">
            
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                        <script>hljs.initHighlightingOnLoad();</script>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
            <link rel="stylesheet" href="../../assets/css/main.min.css">
                <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">
                <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
                <link href="../../stylesheets/extra.css" rel="stylesheet">
                <script src="../../js/extra.js"></script>

            
                
            
     <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>

    <body>
        <div class="container py-3">
            <header>
                    <!-- block header -->
<nav class="navbar navbar-expand-xl border-bottom">
    <div class="container-fluid">
        

        
            <span class=" fs-4 title-color site-name" id="component-site-name" style="text-transform: uppercase;">Torrez MN</span>
        

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
            aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
            <ul class="navbar-nav">

                <!-- block menu -->
                <li class="nav-item">
                    <!-- block menu -->
    
        <li class="nav-item" id="component-menu">
            <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="
                            nav-link text-gray text-decoration-none" href="../..">[Home]</a>
                        </li>
                        <li class="nav-item">
                            <a class="
                            nav-link text-gray text-decoration-none" href="../../about_me/">[About Me]</a>
                        </li>
                        <li class="nav-item">
                            <a class="
                            nav-link text-gray text-decoration-none" href="../../contact/">[Contact]</a>
                        </li>
            </ul>
        </li>
<!-- endblock -->
                </li>
                <!-- endblock -->

                <!-- block search -->
                <li class="nav-item">
                    <a class="collapsed" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        <div class="md-search-icon">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </div>
                    </a>
                </li>
                <!--  endblock -->

                <!-- block source -->
                <li class="nav-item">
                    
                </li>
                <!--  endblock -->
            </ul>
        </div>
    </div>
</nav>
<!--  endblock -->
            </header>

            <main>
                    <!-- block content -->
<section class="container post">
    <article>
        <header>
            
                <h1 class=" title" id="component-title">Gists from console</h1>
            
        </header>
        <p><h2 id="problem">Problem</h2>
<p>As developers, we often find ourselves needing a quick and easy way to save
code snippets or entire scripts for future reference. GitHub Gists provide a
convenient way to store and share these snippets. However, manually creating a
Gist through the GitHub interface can be time-consuming, especially when you
want to save snippets directly from your terminal.</p>
<h2 id="idea">Idea</h2>
<p>To streamline the process of saving code snippets as Gists, I wanted to create
a Fish shell function that could take a file, description, and visibility
setting as arguments, and automatically create a Gist. This way, I could
quickly push snippets to GitHub without leaving the terminal.</p>
<h2 id="stack">Stack</h2>
<p>To implement this solution, I used:</p>
<ul>
<li>
<p><strong>Fish Shell</strong>: A smart and user-friendly command line shell.</p>
</li>
<li>
<p><strong>cURL</strong>: A command line tool for transferring data with URLs.</p>
</li>
<li>
<p><strong>GitHub API</strong>: The interface for creating Gists programmatically.</p>
</li>
<li>
<p><strong>Python</strong>: To handle JSON string processing.</p>
</li>
</ul>
<h2 id="solutions">Solutions</h2>
<h3 id="proposed-solution">Proposed Solution</h3>
<p>The solution involves creating a Fish shell function that:</p>
<ol>
<li>
<p>Takes a filename, description, and visibility setting as inputs.</p>
</li>
<li>
<p>Reads the file content, processes it for safe JSON transfer, and constructs a JSON payload.</p>
</li>
<li>
<p>Sends the payload to GitHub's API to create a new Gist with the provided details.</p>
</li>
</ol>
<h3 id="token-creation">Token Creation</h3>
<p>Before you can use this function, you'll need a GitHub token with <code>gists</code>
permissions. Here’s how to create it:</p>
<ol>
<li>
<p><strong>Go to GitHub</strong>: Log in to your GitHub account and navigate to
   <a href="https://github.com/settings/profile">Settings</a>.</p>
</li>
<li>
<p><strong>Generate Token</strong>: Under "Developer settings," click on "Personal access
   tokens" and generate a new token.</p>
</li>
<li>
<p><strong>Set Permissions</strong>: Ensure the token has the <code>gists</code> scope enabled. This
   allows the token to create and manage Gists.</p>
</li>
<li>
<p><strong>Store the Token</strong>: Once generated, store the token securely in an
   environment variable, like <code>GITHUB_TOKEN</code>.</p>
</li>
</ol>
<h3 id="exporting-the-token-as-an-environment-variable">Exporting the Token as an Environment Variable</h3>
<p>To make sure your Fish shell function can access your GitHub token, you'll need
to export it as an environment variable. Here’s how you can do it:</p>
<ol>
<li>
<p>Open your terminal.</p>
</li>
<li>
<p>Run the following command to export the token as an environment variable:</p>
</li>
</ol>
<p><code>fish set -Ux GITHUB_TOKEN your_token_here</code></p>
<p>Replace <code>your_token_here</code> with the actual token you generated from GitHub.</p>
<ol>
<li>
<p>This command makes the <code>GITHUB_TOKEN</code> available globally in your Fish shell
sessions.</p>
</li>
<li>
<p>If you want this token to persist across sessions, add the command to your
<code>config.fish</code> file, usually located in <code>~/.config/fish/</code>.</p>
</li>
</ol>
<h2 id="fish-function">Fish Function</h2>
<p>Here's the Fish function to create a Gist:</p>
<pre><code class="language-fish">function new_gist
    # Check if the required arguments are provided
    if test (count $argv) -lt 3
        echo &quot;Usage: new_gist &lt;filename&gt; &lt;description&gt; &lt;visible&gt;&quot;
        return 1
    end

    set filename $argv[1]
    set description $argv[2]
    set visible $argv[3]

    # Convert the &quot;visible&quot; argument to a boolean value
    if test &quot;$visible&quot; = &quot;True&quot;
        set public true
    else if test &quot;$visible&quot; = &quot;False&quot;
        set public false
    else
        echo &quot;The 'visible' argument must be either 'True' or 'False'.&quot;
        return 1
    end

    # Read the file content, escape necessary characters, and handle newlines
    set filecontent (cat $filename | python3 -c 'import json,sys; print(json.dumps(sys.stdin.read()))')

    # Construct the JSON payload using the output from Python
    set payload '{&quot;description&quot;: &quot;'$description'&quot;, &quot;public&quot;: '$public', &quot;files&quot;: {&quot;'$filename'&quot;: {&quot;content&quot;: '$filecontent'}}}'

    # Make the request to create the gist
    curl -L \
    -X POST \
    -H &quot;Accept: application/vnd.github+json&quot; \
    -H &quot;Authorization: Bearer $GITHUB_TOKEN&quot; \
    -H &quot;X-GitHub-Api-Version: 2022-11-28&quot; \
    https://api.github.com/gists \
    -d &quot;$payload&quot;
end
</code></pre>
<h3 id="explanation">Explanation</h3>
<ol>
<li>
<p><strong>Argument Handling</strong>: The function expects three arguments: the file name,
   description, and visibility. If the visibility is not <code>True</code> or <code>False</code>, it
   will prompt the user to correct it.</p>
</li>
<li>
<p><strong>Visibility Handling</strong>: The visibility argument controls whether the Gist
   will be public or private. It converts the string "True" or "False" into a
   boolean value that the GitHub API can process.</p>
</li>
<li>
<p><strong>File Content Processing</strong>: Fish shell and JSON processing can be tricky
   due to special characters and newlines. This function uses Python to safely
   encode the file content into a JSON-compatible format.</p>
</li>
<li>
<p><strong>Payload Construction</strong>: The JSON payload is built using the provided
   arguments and processed content, ensuring it is correctly formatted for the
   GitHub API.</p>
</li>
<li>
<p><strong>cURL Command</strong>: The function uses cURL to send the request to GitHub,
   leveraging the personal access token for authentication.</p>
</li>
</ol>
<h3 id="how-to-use-the-function">How to Use the Function</h3>
<ol>
<li><strong>Navigate to the directory</strong> containing the file you want to save as a Gist.</li>
<li><strong>Run the command</strong>: <code>new_gist &lt;file.ext&gt; &lt;description&gt; &lt;visible&gt;</code>.</li>
<li>For example: <code>new_gist myscript.py "My Python Script" True</code>.</li>
<li><strong>Check GitHub</strong>: Your new Gist should now be available in your GitHub account, either as a public or private Gist, depending on the visibility you set.</li>
</ol>
<h2 id="conclusions">Conclusions</h2>
<p>This Fish shell function significantly simplifies the process of saving code
snippets to GitHub Gists, making it quick and convenient to store and share
code directly from the terminal. The flexibility to set the visibility of the
Gist ensures you can control who has access to your snippets, whether they are
public or private.</p>
<hr />
<p><sub>Blog post created with the assistance of ChatGPT. Big thanks to OpenAI and my own tinkering brain for making this possible!</sub></p></p>
    </article>
</section>
<!-- endblock -->
            </main>

            
                    <!-- block preview -->
<!-- endblock -->
            

            
                    <!-- block footer -->
<footer class="pt-4 my-md-5 pt-md-5 border-top" id="component-footer">
    <div class="row">
        <div class="col-12 col-md">
                <!-- block copyright -->

    <small class="d-block mb-3">
        Made with
        <a href="https://github.com/FernandoCelmer/mkdocs-simple-blog" target="_blank" rel="noopener">
            Simple Blog for MkDocs
        </a>
    </small>

<!-- endblock -->
        </div>
    </div>
</footer>
<!-- endblock -->
            
        </div>

            <script>var base_url = '../..';</script>
            <script src="../../assets/js/jquery-3.3.1.slim.min.js""></script>
            <script src="../../assets/js/bootstrap.bundle.min.js""></script>
            <script src="../../assets/js/main.min.js""></script>
                <script src="../../js/extra.js" defer></script>

    <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body>

</html>